{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/marci/source/repos/jgmarry.me/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"C:/Users/marci/source/repos/jgmarry.me/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Users/marci/source/repos/jgmarry.me/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _asyncToGenerator from\"C:/Users/marci/source/repos/jgmarry.me/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import React,{useState}from\"react\";import Select from\"react-select\";import{StatusCodes}from\"http-status-codes\";import\"../styles/signup.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function updateFamily(_x){return _updateFamily.apply(this,arguments);}function _updateFamily(){_updateFamily=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(family){var requestOptions,BACKEND_URL,result;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:requestOptions={method:\"PUT\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(family)};BACKEND_URL=\"https://us-central1-wedding-41b3e.cloudfunctions.net\";_context2.next=4;return fetch(\"\".concat(BACKEND_URL,\"/signup\"),requestOptions).then(function(response){return response.status;}).catch(function(_){return StatusCodes.SERVICE_UNAVAILABLE;});case 4:result=_context2.sent;console.log(\"\\n ======= While updating family, backend response was: \".concat(result,\" ======= \\n\"));return _context2.abrupt(\"return\",result);case 7:case\"end\":return _context2.stop();}},_callee2);}));return _updateFamily.apply(this,arguments);}var DIETS=[{value:\"podstawowa\",label:\"podstawowa\"},{value:\"wegetariańska\",label:\"wegetariańska\"},{value:\"wegańska\",label:\"wegańska\"},{value:\"bez laktozy\",label:\"bez laktozy\"},{value:\"bez glutenu\",label:\"bez glutenu\"}];export default function Signup(_ref){var family=_ref.family,onFamilyUpdate=_ref.onFamilyUpdate;var members=family.members;var _useState=useState(function(){return setDiets();}),_useState2=_slicedToArray(_useState,2),chosenDiets=_useState2[0],setChosenDiets=_useState2[1];function setDiets(){var diets={};for(var i=0;i<members.length;i++){diets[i]={value:members[i].diet,label:members[i].diet};}return diets;}function handleSelect(guestChoice,i){var diets=_objectSpread({},chosenDiets);diets[i]=guestChoice;setChosenDiets(diets);}function handleSubmit(_x2){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(event){var i,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:event.preventDefault();for(i=0;i<members.length;i++){family.members[i].has_confirmed=event.target[\"hasConfirmed\".concat(i)].checked;family.members[i].diet=chosenDiets[i].value;}family.needs_accomodation=event.target[\"needsAccomodation\"].checked;_context.next=5;return updateFamily(family);case 5:result=_context.sent;if(result===StatusCodes.NO_CONTENT){onFamilyUpdate();}else if(result===StatusCodes.SERVICE_UNAVAILABLE||result===undefined){alert(\"tymczasowe problemy z serwerem. spróbuj później.\");// send mail here - set mail in .env (with controll to max 10 mails)\n}else{alert(\"spróbuj ponownie.\");}case 7:case\"end\":return _context.stop();}},_callee);}));return _handleSubmit.apply(this,arguments);}return/*#__PURE__*/_jsx(\"div\",{className:\"signup__container container\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,method:\"POST\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"signup__grid\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"signup__grid-title\",children:\"Go\\u015B\\u0107\"}),/*#__PURE__*/_jsx(\"div\",{className:\"signup__grid-title\",children:\"Obecno\\u015B\\u0107\"}),/*#__PURE__*/_jsx(\"div\",{className:\"signup__grid-title\",children:\"Dieta\"}),members.map(function(member,i){return/*#__PURE__*/_jsxs(React.Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"line\"}),/*#__PURE__*/_jsx(\"div\",{children:member.name}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"label\",{className:\"toggler-wrapper style-25\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"hasConfirmed\".concat(i),defaultChecked:member.has_confirmed,id:i}),/*#__PURE__*/_jsx(\"div\",{className:\"toggler-slider\",children:/*#__PURE__*/_jsx(\"div\",{className:\"toggler-knob\"})})]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Select,{value:chosenDiets[i],options:DIETS,onChange:function onChange(e){return handleSelect(e,i);},placeholder:\"Wybierz dietę...\",styles:{control:function control(baseStyles,state){return _objectSpread(_objectSpread({},baseStyles),{},{borderColor:state.isFocused?'grey':'#44cc66',minWidth:'130px'});}}})})]},i);})]}),/*#__PURE__*/_jsx(\"div\",{className:\"line\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"centered-content\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"signup__table-title\",children:\"Chcieliby\\u015Bmy otrzyma\\u0107 zakwaterowanie\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"label\",{className:\"toggler-wrapper style-25\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",name:\"needsAccomodation\",defaultChecked:family.needs_accomodation}),/*#__PURE__*/_jsx(\"div\",{className:\"toggler-slider\",children:/*#__PURE__*/_jsx(\"div\",{className:\"toggler-knob\"})})]})})]}),/*#__PURE__*/_jsx(\"input\",{type:\"submit\",value:\"Wy\\u015Blij\",className:\"signup__button button\"})]})});}","map":{"version":3,"names":["React","useState","Select","StatusCodes","updateFamily","family","requestOptions","method","headers","body","JSON","stringify","BACKEND_URL","fetch","then","response","status","catch","_","SERVICE_UNAVAILABLE","result","console","log","DIETS","value","label","Signup","onFamilyUpdate","members","setDiets","chosenDiets","setChosenDiets","diets","i","length","diet","handleSelect","guestChoice","handleSubmit","event","preventDefault","has_confirmed","target","checked","needs_accomodation","NO_CONTENT","undefined","alert","map","member","name","e","control","baseStyles","state","borderColor","isFocused","minWidth"],"sources":["C:/Users/marci/source/repos/jgmarry.me/src/components/signup.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport Select from \"react-select\"\r\nimport { StatusCodes } from \"http-status-codes\";\r\nimport \"../styles/signup.css\"\r\n\r\nasync function updateFamily(family){\r\n    const requestOptions = {\r\n        method: \"PUT\",\r\n        headers: {\r\n            \"Content-Type\": \"application/json\"\r\n        },\r\n        body: JSON.stringify(family)\r\n    };\r\n\r\n    const BACKEND_URL = \"https://us-central1-wedding-41b3e.cloudfunctions.net\";\r\n    \r\n    let result = await fetch(`${BACKEND_URL}/signup`, requestOptions)\r\n        .then(response => { return response.status; })\r\n        .catch(_ => { return StatusCodes.SERVICE_UNAVAILABLE; });\r\n\r\n    console.log(`\\n ======= While updating family, backend response was: ${result} ======= \\n`);\r\n\r\n    return result;\r\n}\r\n\r\nconst DIETS = [\r\n    { value: \"podstawowa\", label: \"podstawowa\" },\r\n    { value: \"wegetariańska\", label: \"wegetariańska\" },\r\n    { value: \"wegańska\", label: \"wegańska\" },\r\n    { value: \"bez laktozy\", label: \"bez laktozy\" },\r\n    { value: \"bez glutenu\", label: \"bez glutenu\" }\r\n];\r\n\r\nexport default function Signup({family, onFamilyUpdate}) {\r\n\r\n    const members = family.members;\r\n    const [chosenDiets, setChosenDiets] = useState(() => setDiets());\r\n\r\n    function setDiets() {\r\n        let diets = {};\r\n\r\n        for (let i = 0; i < members.length; i++) {\r\n            diets[i] = { value: members[i].diet, label: members[i].diet };\r\n        }\r\n        return diets;\r\n    }\r\n\r\n    function handleSelect(guestChoice, i) {\r\n        let diets = { ...chosenDiets };\r\n        diets[i] = guestChoice;\r\n        setChosenDiets(diets);\r\n    }\r\n\r\n    async function handleSubmit(event) {\r\n        event.preventDefault();\r\n\r\n        for (let i = 0; i < members.length; i++) {\r\n            family.members[i].has_confirmed = event.target[`hasConfirmed${i}`].checked;\r\n            family.members[i].diet = chosenDiets[i].value;\r\n        }\r\n\r\n        family.needs_accomodation = event.target[\"needsAccomodation\"].checked;\r\n\r\n        let result = await updateFamily(family);\r\n\r\n        if (result === StatusCodes.NO_CONTENT) {\r\n            onFamilyUpdate();\r\n        }\r\n        else if (result === StatusCodes.SERVICE_UNAVAILABLE || result === undefined) {\r\n            alert(\"tymczasowe problemy z serwerem. spróbuj później.\");\r\n            // send mail here - set mail in .env (with controll to max 10 mails)\r\n        }\r\n        else {\r\n            alert(\"spróbuj ponownie.\");\r\n        }\r\n    }\r\n\r\n    return (\r\n      <div className=\"signup__container container\">\r\n        <form onSubmit={handleSubmit} method=\"POST\">\r\n          <div className=\"signup__grid\">\r\n            <div className=\"signup__grid-title\">Gość</div>\r\n            <div className=\"signup__grid-title\">Obecność</div>\r\n            <div className=\"signup__grid-title\">Dieta</div>\r\n            {members.map((member, i) => (\r\n              <React.Fragment key={i}>\r\n                <div className=\"line\"></div>\r\n                <div>{member.name}</div>\r\n\r\n                <div>\r\n                  <label className=\"toggler-wrapper style-25\">\r\n                    <input\r\n                      type=\"checkbox\"\r\n                      name={`hasConfirmed${i}`}\r\n                      defaultChecked={member.has_confirmed}\r\n                      id={i}\r\n                    />\r\n                    <div className=\"toggler-slider\">\r\n                      <div className=\"toggler-knob\"></div>\r\n                    </div>\r\n                  </label>\r\n                </div>\r\n\r\n                <div>\r\n                  <Select\r\n                    value={chosenDiets[i]}\r\n                    options={DIETS}\r\n                    onChange={(e) => handleSelect(e, i)}\r\n                    placeholder={\"Wybierz dietę...\"}\r\n                    styles={{\r\n                      control: (baseStyles, state) => ({\r\n                        ...baseStyles,\r\n                        borderColor: state.isFocused ? 'grey' : '#44cc66',\r\n                        minWidth: '130px'\r\n                      }),\r\n                    }}\r\n                  />\r\n                </div>\r\n              </React.Fragment>\r\n            ))}\r\n          </div>\r\n          <div className=\"line\"></div>\r\n          <div className=\"centered-content\">\r\n            <div className=\"signup__table-title\">\r\n              Chcielibyśmy otrzymać zakwaterowanie\r\n            </div>\r\n            <div>\r\n              <label className=\"toggler-wrapper style-25\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  name={\"needsAccomodation\"}\r\n                  defaultChecked={family.needs_accomodation}\r\n                />\r\n                <div className=\"toggler-slider\">\r\n                  <div className=\"toggler-knob\"></div>\r\n                </div>\r\n              </label>\r\n            </div>\r\n          </div>\r\n          <input\r\n            type=\"submit\"\r\n            value=\"Wyślij\"\r\n            className=\"signup__button button\"\r\n          ></input>\r\n        </form>\r\n      </div>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}